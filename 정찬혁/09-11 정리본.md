# 09-11

```sql
select e.ename, e.deptno, d.dname 
from emp e, dept d
where e.deptno = d.deptno;
```

- emp 테이블의 deptno와 dept 테이블의 deptno가 같은 값을 가진 e.ename, e.deptno, d.dname을 출력

### LEFT OUTER JOIN

```sql
select e.ename, e.deptno, d.dname
from emp e 
right outer join dept d using(deptno);
```

- join 키워드 옆에 있는 게 오른쪽 테이블, left면 옆에 있는 게 왼쪽 테이블, 값이 없으면 null로 표시

### 서브쿼리

- 하나의 SQL 질의문 속에 다른 SQL 질의문이 포함되어 있는 형태

```sql
select *
from emp
where sal < (select avg(sal) from emp);
```

- 평균 급여보다 적은 급여를 받는 사원

```sql
select *
from emp
where deptno = (select deptno from dept where dname = "SALES");
```

- 서브쿼리 출력값
    - deptno → 30, dname → SALES, loc → CHICAGO
- emp 테이블에서 deptno 값이 30인 속성들 모두 출력

```sql
/* 실행시 오류
select ename, sal 
from emp
where sal < (select avg(sal) from emp group by deptno);
 -- 서브쿼리의 결과가 1개가 아니라 여러개를 반환하면 in, ,any, all과 같은 연산자를 써야한다.
*/

select ename, sal 
from emp
where sal in (select max(sal) from emp group by deptno);  

-- 서브쿼리 출력값 : 5000, 3000, 2850 
```

- 값이 3개인데 < 부등호로 어떤 거랑 비교할지 모름
- 즉 in을 써서 2850, 3000, 5000이 있는 ename과 sal을 출력한다.

```sql
SELECT ename, sal
FROM emp
WHERE sal > ALL (
    SELECT sal
    FROM emp
    WHERE deptno = 30
);

SELECT ename, sal
FROM emp
WHERE sal > ANY (
    SELECT sal
    FROM emp
    WHERE deptno = 30
);

-- 서브쿼리 출력값 : 950, 1250, 1500, 1600, 2850
```

- 서브쿼리 출력값과 sal을 하나씩 비교한다.
- ALL은 AND느낌, 서브쿼리 출력값의 모든걸 만족해야 한다.
    - 2850 보다 큰 sal값만 출력하게 된다.
- ANY OR느낌, 서브 쿼리값중 하나라도 만족하면 출력
    - 꼭 2850 보다 큰 값만 출력하는 것이 아닌 하나의 값이라도 만족하면 출력
    - 950보다 크다? 오케이 만족 너 출력 (1100 출력)

### 상관 서브쿼리

외부 쿼리와 내부 쿼리가 서로 연관되어 있는 서브쿼리

```sql
SELECT o.ename, o.sal, o.deptno
FROM emp o
WHERE o.sal > (
    SELECT AVG(i.sal)
    FROM emp i
    WHERE i.deptno = o.deptno
);
```

- 

---

| **SQL 분류** | **명령어** | **설명** |
| --- | --- | --- |
| **DDL** | CREATE, ALTER, DROP, TRUNCATE | 구조 정의 |
| **DML** | INSERT, UPDATE, DELETE, SELECT | 데이터 조작 |
| **DCL** | GRANT, REVOKE | 권한 제어 |
| **TCL** | COMMIT, ROLLBACK | 트랜잭션 제어 |

### 1-2. DDL 명령어 요약

- **CREATE TABLE**: 테이블 생성
- **ALTER TABLE**: 테이블 구조 변경
- **DROP TABLE**: 테이블 삭제
- **RENAME**: 이름 변경
- **TRUNCATE**: 테이블의 모든 데이터 삭제
- **COMMENT**: 테이블에 설명 추가

```sql
CREATE TABLE 테이블이름 (
    필드이름1 필드타입1 [제약조건],
    필드이름2 필드타입2 [제약조건],
    ...
    [테이블 제약조건]
);
```

### 제약조건

| **제약조건** | **설명** |
| --- | --- |
| **NOT NULL** | NULL을 허용하지 않음 |
| **UNIQUE** | 중복된 값을 허용하지 않음 |
| **PRIMARY KEY** | NOT NULL + UNIQUE |
| **FOREIGN KEY** | 다른 테이블 참조 |
| **DEFAULT** | 기본값 설정 |
| **CHECK** | 값의 범위 제한 |
| **AUTO_INCREMENT** | 자동 증가 |

```sql
CREATE TABLE employees (
	 employee_id INT(11) PRIMARY KEY AUTO_INCREMENT, -- PK, 값이 들어오면 1씩 자동 증가
	 first_name VARCHAR(20), -- 문자 길이 20으로 제한
   last_name VARCHAR(25) NOT NULL, -- null이 올 수 없다. 무조건 값을 넣어야함.
   email VARCHAR(25) NOT NULL UNIQUE, -- 중복된 값 X
   department_id INT(11) UNSIGNED, -- 숫자형 데이터 타입에서 부호(+,-) 허용X, 0이상의 값만 저장하는 제약
);
```